#, key=paste0(user, "-", Regressor)
) %>%
dplyr::select(-Month, -Year) %>%
group_nest(user, Regressor, Category) %>%
mutate(data=map(data, function(data) {
seq.Date(from = min(data[["Date"]])
, to = max(data[["Date"]])
, by = "month") %>%
enframe(value = "Date") %>%
left_join(data) %>%
replace_na(list(Quantity=0)) %>%
dplyr::select(-name)
})) %>%
unnest(data)
reg_values_data %>%
bind_rows(.id = "user") %>%
mutate(Date=lubridate::parse_date_time(paste0(Year,"-", Month, "-", "01")
, orders = "ymd") %>% as.Date()
#, key=paste0(user, "-", Regressor)
) %>%
dplyr::select(-Month, -Year) %>%
group_nest(user, Regressor, Category) %>%
mutate(data=map(data, function(data) {
seq.Date(from = min(data[["Date"]])
, to = max(data[["Date"]])
, by = "month") %>%
enframe(value = "Date") %>%
left_join(data, by="Date") %>%
replace_na(list(Quantity=0)) %>%
dplyr::select(-name)
})) %>%
unnest(data)
reg_values_data %>%
bind_rows(.id = "user") %>%
mutate(Date=lubridate::parse_date_time(paste0(Year,"-", Month, "-", "01")
, orders = "ymd") %>% as.Date()
#, key=paste0(user, "-", Regressor)
) %>%
dplyr::select(-Month, -Year) %>%
group_nest(user, Regressor, Category) %>%
mutate(data=map(data, function(data) {
seq.Date(from = min(data[["Date"]])
, to = max(data[["Date"]])
, by = "month") %>%
enframe(value = "Date") %>%
left_join(data, by="Date") %>%
replace_na(list(Quantity=0)) %>%
dplyr::select(-name)
})) %>%
unnest(data) %>% View()
reg_values_data
reg_values_data
reg_values_data %>%
bind_rows(.id = "user") %>%
mutate(Date=lubridate::parse_date_time(paste0(Year,"-", Month, "-", "01")
, orders = "ymd") %>% as.Date()
#, key=paste0(user, "-", Regressor)
) %>%
dplyr::select(-Month, -Year) %>%
group_nest(user, Regressor, Category) %>%
mutate(data=map(data, function(data) {
seq.Date(from = min(data[["Date"]])
, to = max(data[["Date"]])
, by = "month") %>%
enframe(value = "Date") %>%
left_join(data, by="Date") %>%
replace_na(list(Quantity=0)) %>%
dplyr::select(-name)
}))
test <- reg_values_data %>%
bind_rows(.id = "user") %>%
mutate(Date=lubridate::parse_date_time(paste0(Year,"-", Month, "-", "01")
, orders = "ymd") %>% as.Date()
#, key=paste0(user, "-", Regressor)
) %>%
dplyr::select(-Month, -Year) %>%
group_nest(user, Regressor, Category) %>%
mutate(data=map(data, function(data) {
seq.Date(from = min(data[["Date"]])
, to = max(data[["Date"]])
, by = "month") %>%
enframe(value = "Date") %>%
left_join(data, by="Date") %>%
replace_na(list(Quantity=0)) %>%
dplyr::select(-name)
})) %>%
unnest(data)
test
test <- reg_values_data %>%
bind_rows(.id = "user") %>%
mutate(Date=lubridate::parse_date_time(paste0(Year,"-", Month, "-", "01")
, orders = "ymd") %>% as.Date()
#, key=paste0(user, "-", Regressor)
) %>%
dplyr::select(-Month, -Year) %>%
group_nest(user, Regressor, Category) %>%
mutate(data=map(data, function(data) {
seq.Date(from = min(data[["Date"]])
, to = max(data[["Date"]])
, by = "month") %>%
enframe(value = "Date") %>%
left_join(data, by="Date") %>%
replace_na(list(Quantity=0)) %>%
dplyr::select(-name)
}))
test <- reg_values_data %>%
bind_rows(.id = "user") %>%
mutate(Date=lubridate::parse_date_time(paste0(Year,"-", Month, "-", "01")
, orders = "ymd") %>% as.Date()
#, key=paste0(user, "-", Regressor)
) %>%
dplyr::select(-Month, -Year) %>%
group_nest(user, Regressor, Category) %>%
mutate(data=map(data, function(data) {
seq.Date(from = min(data[["Date"]])
, to = max(data[["Date"]])
, by = "month") %>%
enframe(value = "Date") %>%
left_join(data, by="Date") %>%
replace_na(list(Quantity=0)) %>%
dplyr::select(-name)
}))
test
test$data[[1]]
test$data[[1]]
test$data[[1]][nrow(test$data[[1]]),]
test$data[[1]][nrow(test$data[[1]]),]$Date
reg_values_data %>%
bind_rows(.id = "user") %>%
mutate(Date=lubridate::parse_date_time(paste0(Year,"-", Month, "-", "01")
, orders = "ymd") %>% as.Date()
#, key=paste0(user, "-", Regressor)
) %>%
dplyr::select(-Month, -Year) %>%
group_nest(user, Regressor, Category) %>%
mutate(data=map(data, function(data) {
seq.Date(from = min(data[["Date"]])
, to = max(data[["Date"]]+months(1))
, by = "month") %>%
enframe(value = "Date") %>%
left_join(data, by="Date") %>%
replace_na(list(Quantity=0)) %>%
dplyr::select(-name)
}))
reg_values_data %>%
bind_rows(.id = "user") %>%
mutate(Date=lubridate::parse_date_time(paste0(Year,"-", Month, "-", "01")
, orders = "ymd") %>% as.Date()
#, key=paste0(user, "-", Regressor)
) %>%
dplyr::select(-Month, -Year) %>%
group_nest(user, Regressor, Category) %>%
mutate(data=map(data, function(data) {
seq.Date(from = min(data[["Date"]])
, to = max(data[["Date"]]+months(1))
, by = "month") %>%
enframe(value = "Date") %>%
left_join(data, by="Date") %>%
replace_na(list(Quantity=0)) %>%
dplyr::select(-name)
})) %>%
unnest(data)
test <- reg_values_data %>%
bind_rows(.id = "user") %>%
mutate(Date=lubridate::parse_date_time(paste0(Year,"-", Month, "-", "01")
, orders = "ymd") %>% as.Date()
#, key=paste0(user, "-", Regressor)
) %>%
dplyr::select(-Month, -Year) %>%
group_nest(user, Regressor, Category) %>%
mutate(data=map(data, function(data) {
seq.Date(from = min(data[["Date"]])
, to = max(data[["Date"]]+months(1))
, by = "month") %>%
enframe(value = "Date") %>%
left_join(data, by="Date") %>%
replace_na(list(Quantity=0)) %>%
dplyr::select(-name)
})) %>%
unnest(data)
test <- reg_values_data %>%
bind_rows(.id = "user") %>%
mutate(Date=lubridate::parse_date_time(paste0(Year,"-", Month, "-", "01")
, orders = "ymd") %>% as.Date()
#, key=paste0(user, "-", Regressor)
) %>%
dplyr::select(-Month, -Year) %>%
group_nest(user, Regressor, Category) %>%
mutate(data=map(data, function(data) {
seq.Date(from = min(data[["Date"]])
, to = max(data[["Date"]]+months(1))
, by = "month") %>%
enframe(value = "Date") %>%
left_join(data, by="Date") %>%
replace_na(list(Quantity=0)) %>%
dplyr::select(-name)
}))
test$data[[1]]
test$data[[2]]
test$data[[3]]
test$data[[4]]
lubridate::parse_date_time("2018-00-01", orders = "ymd")
message("Appending zeros to regressor's values...")
reg_values_data <- reg_values_data %>%
bind_rows(.id = "user") %>%
mutate(Year=str_sub(Year, start = -2, end=-1)
, Date=lubridate::parse_date_time(paste0(Year,"-", Month, "-", "01")
, orders = "ymd") %>%
as.Date()) %>%
dplyr::select(-Month, -Year) %>%
group_nest(user, Regressor, Category) %>%
mutate(data=map(data, function(data) {
seq.Date(from = min(data[["Date"]])
, to = max(data[["Date"]]+months(1))
, by = "month") %>%
enframe(value = "Date") %>%
left_join(data, by="Date") %>%
replace_na(list(Quantity=0)) %>%
dplyr::select(-name)
})) %>%
unnest(data)
reg_values_data
reg_values_data %>%
bind_rows(.id = "user") %>%
mutate(Year=str_sub(Year, start = -2, end=-1)
, Date=lubridate::parse_date_time(paste0(Year,"-", Month, "-", "01")
, orders = "ymd") %>%
as.Date()) %>%
dplyr::select(-Month, -Year) %>%
group_nest(user, Regressor, Category) %>%
mutate(data=map(data, function(data) {
seq.Date(from = min(data[["Date"]])
, to = max(data[["Date"]]+months(1))
, by = "month") %>%
enframe(value = "Date") %>%
left_join(data, by="Date") %>%
replace_na(list(Quantity=0)) %>%
dplyr::select(-name)
})) %>%
unnest(data) %>%
mutate(Date=paste0(str_extract(Date, "^[0-9]{4}")))
reg_list_data <- purrr::map(paste0(dir_path, reg_list_files)
, .f = ~suppressMessages(readr::read_csv(.x)))
reg_values_data <- purrr::map(paste0(dir_path, reg_values_files)
, .f = ~suppressMessages(readr::read_csv(.x)))
# Naming frames
names(reg_list_data) <- stringr::str_remove_all(reg_list_files, "_reg_list.csv")
names(reg_values_data) <- stringr::str_remove_all(reg_values_files, "_reg_values.csv")
message(
paste0(names(reg_list_data)," added ", map(reg_list_data, nrow), " regressors \n")
, paste0(names(reg_values_data)," added ", map(reg_values_data, nrow), " values \n")
)
# Append zeros to the last value?
message("Appending zeros to regressor's values...")
reg_values_data <- reg_values_data %>%
bind_rows(.id = "user") %>%
mutate(Year=str_sub(Year, start = -2, end=-1)
, Date=lubridate::parse_date_time(paste0(Year,"-", Month, "-", "01")
, orders = "ymd") %>%
as.Date()) %>%
dplyr::select(-Month, -Year) %>%
group_nest(user, Regressor, Category) %>%
mutate(data=map(data, function(data) {
seq.Date(from = min(data[["Date"]])
, to = max(data[["Date"]]+months(1))
, by = "month") %>%
enframe(value = "Date") %>%
left_join(data, by="Date") %>%
replace_na(list(Quantity=0)) %>%
dplyr::select(-name)
})) %>%
unnest(data)
reg_values_data
reg_values_data %>%
mutate(Date=paste0(str_extract(Date, "^[0-9]{4}")))
reg_values_data %>%
mutate(Date=paste0(str_extract(Date, "-[0-9]{2}-")
, "-"
, str_extract(Date, "^[0-9]{4}")))
reg_values_data %>%
mutate(Date=paste0(str_extract(Date, "-([0-9]{2})-")
, "-"
, str_extract(Date, "^[0-9]{4}")))
reg_values_data %>%
mutate(Date=paste0(str_extract(Date, "(?<=-)[0-9]{2}(?=-)")
, "-"
, str_extract(Date, "^[0-9]{4}")))
reg_values_data %>%
mutate(Date=paste0(str_extract(Date, "(?<=-)[0-9]{2}(?=-)")
, "-01-"
, str_extract(Date, "^[0-9]{4}")))
reg_values_data %>%
bind_rows(.id = "user") %>%
mutate(Year=str_sub(Year, start = -2, end=-1)
, Date=lubridate::parse_date_time(paste0(Year,"-", Month, "-", "01")
, orders = "ymd") %>%
as.Date()) %>%
dplyr::select(-Month, -Year) %>%
group_nest(user, Regressor, Category) %>%
mutate(data=map(data, function(data) {
seq.Date(from = min(data[["Date"]])
, to = max(data[["Date"]]+months(1))
, by = "month") %>%
enframe(value = "Date") %>%
left_join(data, by="Date") %>%
replace_na(list(Quantity=0)) %>%
dplyr::select(-name)
})) %>%
unnest(data) %>%
mutate(Date=paste0(str_extract(Date, "(?<=-)[0-9]{2}(?=-)")
, "-01-"
, str_extract(Date, "^[0-9]{4}")))
reg_list_data <- purrr::map(paste0(dir_path, reg_list_files)
, .f = ~suppressMessages(readr::read_csv(.x)))
reg_values_data <- purrr::map(paste0(dir_path, reg_values_files)
, .f = ~suppressMessages(readr::read_csv(.x)))
# Naming frames
names(reg_list_data) <- stringr::str_remove_all(reg_list_files, "_reg_list.csv")
names(reg_values_data) <- stringr::str_remove_all(reg_values_files, "_reg_values.csv")
message(
paste0(names(reg_list_data)," added ", map(reg_list_data, nrow), " regressors \n")
, paste0(names(reg_values_data)," added ", map(reg_values_data, nrow), " values \n")
)
# Getting files' data
reg_list_files <- list.files(dir_path, pattern = "[0-9]_reg_list.csv")
reg_values_files <- list.files(dir_path, pattern = "[0-9]_reg_values.csv")
# loading data
reg_list_data <- purrr::map(paste0(dir_path, reg_list_files)
, .f = ~suppressMessages(readr::read_csv(.x)))
reg_values_data <- purrr::map(paste0(dir_path, reg_values_files)
, .f = ~suppressMessages(readr::read_csv(.x)))
# Naming frames
names(reg_list_data) <- stringr::str_remove_all(reg_list_files, "_reg_list.csv")
names(reg_values_data) <- stringr::str_remove_all(reg_values_files, "_reg_values.csv")
message(
paste0(names(reg_list_data)," added ", map(reg_list_data, nrow), " regressors \n")
, paste0(names(reg_values_data)," added ", map(reg_values_data, nrow), " values \n")
)
reg_list_files <- list.files(dir_path, pattern = "[0-9]_reg_list.csv")
reg_values_files <- list.files(dir_path, pattern = "[0-9]_reg_values.csv")
reg_values_data <- purrr::map(paste0(dir_path, reg_values_files)
, .f = ~suppressMessages(readr::read_csv(.x)))
reg_values_data
message(
paste0(names(reg_list_data)," added ", map(reg_list_data, nrow), " regressors \n")
, paste0(names(reg_values_data)," added ", map(reg_values_data, nrow), " values \n")
)
reg_list_data <- purrr::map(paste0(dir_path, reg_list_files)
, .f = ~suppressMessages(readr::read_csv(.x)))
reg_list_data
names(reg_list_data) <- stringr::str_remove_all(reg_list_files, "_reg_list.csv")
names(reg_values_data) <- stringr::str_remove_all(reg_values_files, "_reg_values.csv")
message(
paste0(names(reg_list_data)," added ", map(reg_list_data, nrow), " regressors \n")
, paste0(names(reg_values_data)," added ", map(reg_values_data, nrow), " values \n")
)
reg_values_data
reg_values_data <- reg_values_data %>%
bind_rows(.id = "user") %>%
mutate(Year=str_sub(Year, start = -2, end=-1)
, Date=lubridate::parse_date_time(paste0(Year,"-", Month, "-", "01")
, orders = "ymd") %>%
as.Date()) %>%
dplyr::select(-Month, -Year) %>%
group_nest(user, Regressor, Category) %>%
mutate(data=map(data, function(data) {
seq.Date(from = min(data[["Date"]])
, to = max(data[["Date"]]+months(1))
, by = "month") %>%
enframe(value = "Date") %>%
left_join(data, by="Date") %>%
replace_na(list(Quantity=0)) %>%
dplyr::select(-name)
})) %>%
unnest(data) %>%
mutate(Date=paste0(str_extract(Date, "(?<=-)[0-9]{2}(?=-)")
, "-01-"
, str_extract(Date, "^[0-9]{4}")))
reg_values_data
added_reg_values <- reg_values_data %>%
dplyr::select(user, Regressor, Category, Date, Quantity)
added_reg_values
added_reg_list <- bind_rows(reg_list_data, .id = "user") %>%
mutate(Select="N") %>%
dplyr::select(user, Select, Name, Category)
document()
require(devtools)
document()
check()
check()
install("nnet")
install.packages("nnet")
install.packages("nnet")
install.packages("nnet")
check()
require(devtools)
document()
check()
build()
install.packages("~/Projects/Packages/sftools_0.1.3.0.tar.gz", repos = NULL, type = "source")
dir_path
dir_path="C:/Users/I0415596/Desktop/"
# Getting files' data
reg_list_files <- list.files(dir_path, pattern = "[0-9]_reg_list.csv")
reg_values_files <- list.files(dir_path, pattern = "[0-9]_reg_values.csv")
# loading data
reg_list_data <- purrr::map(paste0(dir_path, reg_list_files)
, .f = ~suppressMessages(readr::read_csv(.x)))
reg_values_data <- purrr::map(paste0(dir_path, reg_values_files)
, .f = ~suppressMessages(readr::read_csv(.x)))
reg_list_data
require(tibble)
require(devtools)
document()
check()
check()
check()
build()
message("Please attach the regressor's values and names...")
require(devtools)
check()
build()
exists("reg_values")
T*F
T+F
T|F
T&F
ls <- readxl::read_excel("C:/Users/I0415596/Desktop/extractions/life savings.xlsx")
ls
ls <- readxl::read_excel("C:/Users/I0415596/Desktop/extractions/life savings.xlsx", skip = 2)
ls
ls <- readxl::read_excel("C:/Users/I0415596/Desktop/extractions/life savings.xlsx", skip = 3)
ls
ls <- readxl::read_excel("C:/Users/I0415596/Desktop/extractions/life savings.xlsx", skip = 3) %>%
janitor::clean_names()
require(tidyverse)
ls
ls <- readxl::read_excel("C:/Users/I0415596/Desktop/extractions/life savings.xlsx", skip = 3) %>%
janitor::clean_names()
ls
ls %>%
mutate(key=str_extract(item, "[A-Z]{2}: [0-9]+"))
ls %>%
mutate(key=str_extract(item, "[A-Z]{2}: [0-9]+") %>% str_replace(": ", "-"))
sftools:::load_lifesavers()
lifesavers
ls %>%
mutate(key=str_extract(item, "[A-Z]{2}: [0-9]+") %>% str_replace(": ", "-")) %>%
left_join(lifesavers %>% dplyr::select(key, lsd))
ls %>%
mutate(key=str_extract(item, "[A-Z]{2}: [0-9]+") %>% str_replace(": ", "-")) %>%
left_join(lifesavers %>% dplyr::select(key, lsd), by = "key")
ls %>%
mutate(key=str_extract(item, "[A-Z]{2}: [0-9]+") %>% str_replace(": ", "-")) %>%
left_join(lifesavers %>% dplyr::select(key, lsd), by = "key") %>%
filter(lsd=="Yes")
ls %>%
mutate(key=str_extract(item, "[A-Z]{2}: [0-9]+") %>% str_replace(": ", "-")) %>%
left_join(lifesavers %>% dplyr::select(key, lsd), by = "key") %>%
filter(lsd=="Yes") %>%
pull(item)
ls %>%
mutate(key=str_extract(item, "[A-Z]{2}: [0-9]+") %>% str_replace(": ", "-")) %>%
left_join(lifesavers %>% dplyr::select(key, lsd), by = "key") %>%
filter(lsd=="Yes") %>%
dplyr::select(item)
ls %>%
mutate(key=str_extract(item, "[A-Z]{2}: [0-9]+") %>% str_replace(": ", "-")) %>%
left_join(lifesavers %>% dplyr::select(key, lsd), by = "key") %>%
filter(lsd=="Yes") %>%
dplyr::select(forecast_item=item) %>%
save(file = "C:/Users/I0415596/Desktop/life_savers.RData")
ls %>%
mutate(key=str_extract(item, "[A-Z]{2}: [0-9]+") %>% str_replace(": ", "-")) %>%
left_join(lifesavers %>% dplyr::select(key, lsd), by = "key") %>%
filter(lsd=="Yes") %>%
dplyr::select(forecast_item=item) %>%
write_csv(path = "C:/Users/I0415596/Desktop/life_savers.csv")
ls %>%
mutate(key=str_extract(item, "[A-Z]{2}: [0-9]+") %>% str_replace(": ", "-")) %>%
left_join(lifesavers %>% dplyr::select(key, lsd), by = "key") %>%
filter(lsd=="Yes") %>%
dplyr::select(forecast_item=item) %>%
xlsx::write.xlsx(file = "C:/Users/I0415596/Desktop/life_savers.xlsx")
ls %>%
mutate(key=str_extract(item, "[A-Z]{2}: [0-9]+") %>% str_replace(": ", "-")) %>%
left_join(lifesavers %>% dplyr::select(key, lsd), by = "key") %>%
filter(lsd=="Yes") %>%
dplyr::select(forecast_item=item)
ls %>%
mutate(key=str_extract(item, "[A-Z]{2}: [0-9]+") %>% str_replace(": ", "-")) %>%
left_join(lifesavers %>% dplyr::select(key, lsd), by = "key") %>%
filter(lsd=="Yes") %>%
dplyr::select(forecast_item=item) %>%
filter(str_detect(key, "493856"))
ls %>%
mutate(key=str_extract(item, "[A-Z]{2}: [0-9]+") %>% str_replace(": ", "-")) %>%
left_join(lifesavers %>% dplyr::select(key, lsd), by = "key") %>%
filter(lsd=="Yes") %>%
dplyr::select(forecast_item=item) %>%
filter(str_detect(forecast_item, "493856"))
ls %>%
mutate(key=str_extract(item, "[A-Z]{2}: [0-9]+") %>% str_replace(": ", "-")) %>%
left_join(lifesavers %>% dplyr::select(key, lsd), by = "key") %>%
filter(lsd=="Yes") %>%
dplyr::select(forecast_item=item) %>%
xlsx::write.xlsx(file = "C:/Users/I0415596/Desktop/life_savers2.xlsx")
load("//E21flsbcnschub/BCN_SC_HUB/3 - Forecast/9 - Innovation Incubator/Projects/Cluster 1 optimization vs APO/Data/full_sales.RData")
full_sales
full_sales <- as_tibble(full_slaes)
full_sales <- as_tibble(full_sales)
require(tidyverse)
